<html>
	<head>
		<meta charset="utf-8">
		<title>aaaaa</title>
	</head>
	<body>
		<button onclick="det();">det</button>
		<h5>ins</h5>
		<input type="number" id="inn">
		<h5>ous</h5>
		<input type="number" id="oun">
		<button onclick="start();">start</button>
		<button onclick="stop();">stop</button>
		<p id="text">no signal</p>
	<script type="text/javascript">
var ctx;
var gainnode;
pp=document.getElementById("text");
var ins=[];
var ous=[];
function det(){
tt="<h3>device</h3>";
navigator.mediaDevices.enumerateDevices().then(
	function(devi){
		devi.forEach(
			function(d){
				if(d.kind=="audiooutput"){ous.push(d);};
				if(d.kind=="audioinput"){ins.push(d);};
			}
		)
		tt=tt+"input==<br>";
		for(i=0;i<ins.length;i++){
			tt=tt+ins[i].label+"<br>";
		}
		tt=tt+"outputs==<br>";
		for(i=0;i<ous.length;i++){
			tt=tt+ous[i].label+"<br>";
		}
		pp.innerHTML=tt;
	}
)
}
function start(){
	pp.innerHTML="stream!!";
	if(ctx){
		pp.innerHTML="START";
		gainnode.gain.value=1.0;
		return;
	};
	oun=document.getElementById("oun").value;
	if(oun!=""){ctx=new AudioContext({ sinkId:ous[oun].deviceId});}
	else{ctx=new AudioContext();};
	navigator.getUserMedia=navigator.getUserMedia || navigator.webkitGetUserMedia;
	inn=document.getElementById("inn").value;
	if(inn==""){con={audio:true};}
	else{con={audio:{deviceId:ins[inn].deviceId}}};
	navigator.getUserMedia(con,play,(er)=>{pp.append(er);});
}
function play(stream){
	source=ctx.createMediaStreamSource(stream);
	gainnode=new GainNode(ctx);
	source.connect(gainnode);
	gainnode.connect(ctx.destination);
}
function stop(){
	pp.innerHTML="STOP";
	gainnode.gain.value=0.0;
}
</script>
	</body>
	
</html>
